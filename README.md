# Racecar AI

A racing car simulation where an AI learns to drive autonomously using a genetic algorithm and a neural network.

## Features

- **Track editor** — draw custom tracks with a mouse, place checkpoints and a finish line, set the car spawn point, and save
- **AI training** — watch the AI learn in real time; best weights are saved automatically and reloaded at the next launch
- **Drive mode** — take control of the car yourself on any saved track

## How it works

The AI uses a simple two-layer neural network:

- **Inputs (6):** car velocity + 5 raycasts (forward and 4 angled sensors)
- **Outputs (8):** discrete action probabilities via softmax (accelerate, brake, steer left/right, combinations)
- **Training:** genetic algorithm — each episode, if the car beats its previous best score the weights are saved; a mutated copy is generated for the next episode

The reward system rewards speed and progress toward checkpoints, and penalises death and excessive steering certainty.

## Files

| File | Description |
|------|-------------|
| `racecar.py` | Main entry point — track editor, AI training, and manual drive mode |
| `reward_system.py` | Reward calculation module used during AI training |
| `tracks.py` | Saved track data (auto-generated by the editor) |
| `Best_weights.py` | Best AI weights found so far (auto-generated during training) |
| `car.png` | Car sprite |

## Requirements

- Python 3.9+
- [pygame](https://www.pygame.org/)
- [numpy](https://numpy.org/)

```bash
python -m venv venv
venv\Scripts\activate      # Windows
pip install pygame numpy
```

## Usage

**Main app (editor + AI + drive):**

```bash
python racecar.py
```

A Tkinter control panel opens alongside the Pygame window. Use the mode dropdown to switch between:

- **Editor** — draw a track with the mouse, place checkpoints and a finish line, position the spawn point, then hit Save
- **AI** — the AI trains automatically; best weights are saved to `Best_weights.py`
- **Drive** — drive the car yourself with the arrow keys; press **R** to respawn

The **Reset weights** button in the panel discards all saved weights and restarts training from scratch.

## Controls

| Key | Action |
|-----|--------|
| Arrow Up | Accelerate |
| Arrow Down | Brake / reverse |
| Arrow Left | Steer left |
| Arrow Right | Steer right |
| R | Respawn (Drive mode only) |

## Notes

- `racecar.py` auto-loads Track 5 on startup (if it exists)
- Training resumes from the best saved weights on each launch
- The genetic algorithm reduces mutation over time (mutation factor decreases with generation count)
